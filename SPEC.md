* 규칙1 : 재미있게써라.
* 규칙2 : 스펙작성은두뇌가실행할코드를저작하는것과같다.
* 규칙3 : 최대한쉽게써라.
* 규칙4 : 여러번다시읽고재검토하라.
* 규칙5 : 표준서식은잊어라.

# 책마다 하나의 git 저장소 #

`삼국지` 의 역자 이문열씨가 찾아와서 ebook 으로 만들고 싶다고 했다.
text 파일을 달라고 했더니 그런거 없고 소설책으로 있다고 했다.
집에 가라고 했다. (나중에 들은 이야기지만 알바를 고용해서 text 파일로
옮겼다고..)

몇일뒤에 `거침없이배우는펄` 의 역자 김도형이 ebook 으로 만들고 싶다고
했다. text 파일을 달라고 했더니 `거침펄.txt` 파일이랑 `image.zip`
파일을 줬다. txt 파일을 열어보니..

    "거침없이 배우는 펄"
    
    * 자료형
    
    자료형이 어쩌고 저쩌고..
    ...
    ...
    
    ** 스칼라
    
    스칼라가 어쩌고 저쩌고...
    ...
    ...
    
    -- 리스트
    
    리스트가 어쩌고 저쩌고...
    ...
    ...
    
    * 연산자
    
    ...
    ...

나름대로 '장', '절', '구' 가 분리되어 있엇지만 미비한 부분은 내가
고치기로 마음먹었다. 그리고 차비주고 돌려보냈다. 1주일뒤에 보자고
했다. text 파일만 받은게 생각나서 "제목", "저자", "커버사진" 을 달라고
메일을 보냈다.

"image.zip" 은 압축을 풀어보니 그냥 `jpg`, `png`, `bmp` 파일이
잔뜩들어 있엇다. `gimp` 를 열어서 `a.bmp` 를 `a.png` 로 바꾸고 `bmp`
파일은 모두 지웠다. 또 찾아보니 `jpeg` 도 잇었다. 
`$ rename s/jpeg$/jpg$/ *.jpeg` 해서 `jpg` 로 바꿧다.

한권의 책은 하나의 git repository 를 가져야하기 때문에
`ebook-init` 스크립트를 이용해서 디렉토리 구조와 출판물을 뽑아낼 수
있는 스크립트들을 만들었다.

    $ mkdir "거침없이배우는펄"
    $ git init
    $ cd "거침없이배우는펄"
    $ ebook-init "김도형" "거침없이배우는펄"
    # mkdir ko/
    # mkdir figures/
    # generate 'makeebooks'

`makeebooks` 는 `progit/progit.git` 의
[makeebooks](https://github.com/progit/progit/blob/master/makeebooks)
스크립트인데, 저자에는 `scott shacon` 대신에 `김도형`이, `progit`
대신에는 `거침없이배우는펄` 이 들어가 있다.

눈에는 보이지 않았지만, `mysql:ebook` database 의 `author`, `book`
테이블에는 해당 정보가 만들어질때 이미 다 들어가 있엇다.

`image.zip` 의 모든 파일을 `figures` 에 옮기고 `거침펄.txt` 를
`00_Learning_Perl.md` 로 이름을 바꾸고 `ko` 디렉토리에 옮기고 commit
하였다.




## 컨텐츠의 포맷을 markdown 으로 변환 ##

일을 시킬 요량으로 차나한잔 마시자고 속이고 김도형을 회사옆 카페베네로
불렀다. 눈치 빠르게 `거침없이배우는펄` 책을 들고왔다. 책을 펴서 목차를
봤더니 12개의 `장` 으로 나뉘어져 있었는데 대략 한개의 `장` 마다 30장씩
분량이었다. `00_Learning_Perl.md` 를 장별로 쪼개야 겠다고 생각했다.

그렇다 이것은 텍스트북의 모듈화였던 것이다.

역자를 만나서 `markdown` 포맷에 대해 설명해주었다.
사실 역자하고는 안엮인다. 나중에 자신도 참여했으니 `markdown` 파일을
받아가려고 들면 곤란하기 때문이다. 그 파일을 가지고 다른 출판사로
찾아가면 우리랑 똑같이 뽑아낼 수 있지 않은가! 하지만 김도형은 뭐 그냥
날로 먹는셈치고 부른 것 이었다.

- `# 장 #`
- `## 절 ##`
- 코드들여쓰기
- 이미지 삽입방법
- 단락나누기

에 대해 설명하였다.

`# 장 #` 에서의 `장` 은 제목에 해당한다. 목차의 큰제목하나를 할당
받는 것이다. 눈치챗겟지만 `## 절 ##` 은 `절` 이다.

혹시나해서 적는다. `장`, `절` 개념에 대해서 말이다.

`성경`을 예로 드는게 적절하다고 생각한다.
`요한복음 1장 3절` 에서 책은 `요한복음` 이고 `1장` 은 첫번째 주제
`3절` 은 첫번째 주제의 3번째 소주제 이다.

크게는 장, 절까지 나뉘지만 더 나눌수도 있다. 하지만 `### 구 ###` 보다
더 깊게 들어가는건 지양하도록 하고 차라리 `단락`으로 나눠 달라고 했다.
**한줄이상의 개행**이 이뤄지면 그것은 `단락`이다.

나의 자세한 설명 덕분인지 커피한잔이 식기전에 txt => markdown 으로의
작업이 끝이났다.




## 이미지 삽입 작업 ##

중간중간에 들어가는 이미지를 보니까..

    중략..
    [그림 5-11.jpg] - 펄의 대표동물 낙타
    중략..

요런식으로 되어 있엇다. 다행인건 그림삽입을 위한 포맷이 전부 같아서
한번에 변환이 가능할 것 같았다.

    [그림 5-11.jpg] - 펄의 대표동물 낙타

를 아래의 형식으로 말이다.

    Insert <file>
    그림 <title>

예를들면

    Insert 5-11.jpg
    그림 펄의 대표동물 낙타.

지난번에는 전부 달라서 다 찾아서 손으로 바꿨던 적이 있엇는데 짱낫지만
먹고살려고 어쩔 수 없이 작업했엇다.



# convert 'md' to 'mobi' #

얼마 안결려 markdown 으로 변환이 끗나고 이미지도 제대로 인식할 수
있도록 변경이 끝났다. `장` 단위로 파일을

- 01_Variables.md
- 02_Operators.md
- ...

으로 나눠서 저장하고 commit 한뒤에

    $ .makeebooks ko

하였더니 `거침없이배우는펄.ko.mobi` 파일이 만들어졌다.


# 웹서비스에 book 추가 #

http://book.silex.kr 에 책을 추가하려면

- .mobi 파일
- 표지사진파일
- book.silex.kr 계정

이 필요하다

로그인후에 http://book.silex.kr/books/add 로 가서 책을 등록했다.

몇가지를 입력해야 했는데,

- 책이름
- 한줄설명
- 저자이름
- 카테고리
- 아마존 link(require) - 업로드 안하고도 서비스 할 수 있지만 편의를
  위해 꼭하라는 의미임
- 출판사이름(option)
- 커버사진(option)
- 요약 설명(option)
- 발행일(option, 오늘이 default)

카테고리는 중복선택이 가능한데,

- 컴퓨터
- 프로그래밍언어
- 요리
- 정치

중에 `컴퓨터`와 `프로그래밍언어`을 선택했다.

출판사 정보가 필요해서 출판사이름을 `지앤` 까지만 쳣는데..

- `지앤스`
- `북지앤`

이 자동완성 추천단어로 나왔다.

내가 찾는건 `지앤선` 이라서 없길래 `지앤선` 이라고 치고 엔터쳤더니
다음부터는 `지앤선`도 자동완성이 되었다.



# http://book.silex.kr #

## /books/:id ##

등록후에는 http://book.silex.kr/books/1394 으로 이동했다.
이게 total 1394번째로 등록된 책이라서 `1394` 으로 이동한것이엇다.

내가 등록했던 책에 대한 상세정보 밑에 `DISQUS` 가 붙었고, `tweet`,
`like` 버튼도 보였다.

DISQUS 를 이용해서 답글을 달 수 있엇고, tweet 버튼을 눌렀더니 twitter
oauth popup 후에, 

> 거침없이 배우는 펄 - http://book.silex.kr/1394

이란 내용으로 트윗할 수 있엇다. 또 like 하니까 내 facebook 에 link 가
like 되어 있었다.

아래쪽에는 **이책을 구입한 사람이 구입한 책** 이 있었는데 지금 막
등록해서 그런지 아무것도 표시되지 않앗다.

한시간 후에 갓을때는 5권의 책이 조그만 이미지와 함께 표시되었는데

제목인 `Intermediate Perl` 을 누르니까 http://book.silex.kr/books/882
로 이동했다.

## /index ##

로고를 누르니까 기대한대로 `/` 첫화면으로 이동했다.
구글처럼 큰 로고하고 검색창이 있고, 카테고리별로 이동할 수 있는 링크가
깨끗하게 정리되어 있엇다.

검색은 자동완성 되었다.



## /search?q=<keyword> ##

`perl` 을 검색했더니,

http://book.silex.kr/search?q=perl

로 이동했고 구글처럼 생겼다.

위에는 검색창에 `perl` 이 입력되어 있고, 왼쪽 sidebar 에는 `help`
링크가 있었으며, 책이름에 링크가 걸려있엇다.

    +-------+
    |       | 거침없이배우는펄 - Learning Perl 6th Edition 의 번역서
    | cover | 조그맣게 설명에관한내용이 써잇음
    |       | 2012.11.13 [amazon link] - 23 like
    +-------+

item 이 10개가 보이고 페이징 할 수 있엇다.


## /ca/:category ##

`컴퓨터` 카테고리를 눌러보았다. `/ca/computer` 로 이동하였고 `/search`
랑 똑같이 생겻는데 최근 등록일 기준으로 보였다. `most | recent` 중에
**recent** 로 되어있엇다. **most** 를 누르니까 가장 인기 있는 책부터 정렬되었다.







# 문제점 #

- 저자, 역자와의 돈계산
- 누구나 upload 할 수 있는데 upload 한사람과의 돈계산
